<!DOCTYPE html>
<html>

<head>
  <title>Geometric camera example</title>
</head>

<body>
  <script type="application/javascript" src="../lib/agent.js"></script>
  <script>
    const vshr = `
      attribute vec2 aPos;
      uniform mat4 camera;

      void main() {
        gl_Position = camera * vec4(aPos, 0.0, 1.0);
      }
    `;
    const fshr = `
      precision mediump float;
      uniform vec4 uColor;

      void main() {
        gl_FragColor = uColor;//vec4(1.0, 0.0, 0.0, 1.0);
      }
		`;
		let engine = new Agent.Engine({width: 1200, height: 800});
		let square = new Agent.Square(10, 100, 128, 328);
    let square2 = new Agent.Square(210, 10, 100, 175);
    let square3 = new Agent.Square(300, 120, 50, 50);
    let camera = new Agent.OrthographicCamera({left:0, right:1200, top:0, bottom:800, far:0, near:100});

		let scene = engine.newScene('worldScene');

    scene.addShader(Agent.ShaderType.Vertex, vshr);
    scene.addShader(Agent.ShaderType.Fragment, fshr);

    scene.shader(Agent.ShaderType.Fragment).setUniformDataFor('uColor', {dataValue: [0.0, 0.15, 1.0, 1.0]});
    scene.shader(Agent.ShaderType.Vertex).setUniformDataFor('camera', {dataMatrix: camera.matrix()});

		scene.shader(Agent.ShaderType.Vertex)
      .setAttributeDataFor('aPos', [
        { vertexAttribute: square.vertexAttributes() },
        { vertexAttribute: square2.vertexAttributes() },
        { vertexAttribute: square3.vertexAttributes() },
      ]);

    scene.addDrawable(square, square2, square3);
    scene.addCamera(camera);

    engine.render();
  </script>
</body>

</html>
