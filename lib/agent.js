!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Agent=e():t.Agent=e()}(window,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(1);e.Vector2=i.Vector2;var a=r(4);e.Vector3=a.Vector3;var s=r(3);e.Matrix4=s.Matrix4,function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(e.Axis||(e.Axis={})),e.toRadian=function(t){const e=t/360*2*Math.PI;return parseFloat(e.toFixed(5))},e.toDegree=function(t){return Math.round(t/(2*Math.PI)*360)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t=0,e=0){this.x=t,this.y=e,this.z=0}add(t){return new i(t.x+this.x,t.y+this.y)}sub(t){return new i(this.x-t.x,this.y-t.y)}mult(t){return new i(this.x*t.x,this.y*t.y)}div(t){if(0===t.x||0===t.y)throw new TypeError(`Can not divide by zero x:${t.x} y:${t.y}`);return new i(this.x/t.x,this.y/t.y)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}scale(t){return new i(this.x*t,this.y*t)}normalize(){const t=this.length();return new i(this.x/t,this.y/t)}flatten(){return new Float32Array([this.x,this.y])}}e.Vector2=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(10);e.default=i.Shader,function(t){t[t.Vertex=WebGLRenderingContext.VERTEX_SHADER]="Vertex",t[t.Fragment=WebGLRenderingContext.FRAGMENT_SHADER]="Fragment"}(e.ShaderType||(e.ShaderType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(1),a=r(0);class s{constructor(t){void 0!==t&&16===t.length?this.data=t.map(t=>t):(this.data=new Float32Array(16),this.data[0]=1,this.data[5]=1,this.data[10]=1,this.data[15]=1)}setAsIdentity(){this.data.fill(0),this.data[0]=1,this.data[5]=1,this.data[10]=1,this.data[15]=1}setAsOrthographic(t){this.setAsIdentity(),this.data[0]=2/(t.right-t.left),this.data[5]=2/(t.top-t.bottom),this.data[10]=-2/(t.far-t.near),this.data[12]=(t.right+t.left)/(t.right-t.left)*-1,this.data[13]=(t.top+t.bottom)/(t.top-t.bottom)*-1,this.data[14]=(t.far+t.near)/(t.far-t.near)*-1}setAsPerspective(){}scale(t){let e=1,r=1,i=1;const a=new s(this.data);return"object"==typeof t?(e=t.x,r=t.y,i=t.z||1):(e=t,r=t,i=t),a.data[0]*=e,a.data[5]*=r,a.data[10]*=i,a}translate(t){let e=0,r=0,a=0;const n=new s(this.data);return t instanceof i.Vector2?(e=t.x,r=t.y,a=0):(e=t.x,r=t.y,a=t.z||0),n.data[12]+=e,n.data[13]+=r,n.data[14]+=a,n}rotate(t,e){const r=new s(this.data);switch(e){case a.Axis.X:r.data[5]*=Math.cos(t),r.data[6]*=Math.sin(t),r.data[9]*=-Math.sin(t),r.data[10]*=Math.cos(t);break;case a.Axis.Y:r.data[0]*=Math.cos(t),r.data[2]*=-Math.sin(t),r.data[8]*=Math.sin(t),r.data[10]*=Math.cos(t);break;case a.Axis.Z:r.data[0]*=Math.cos(t),r.data[1]*=Math.sin(t),r.data[4]*=-Math.sin(t),r.data[5]*=Math.cos(t)}return r}flatten(){return this.data}}e.Matrix4=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class i{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.z=r}add(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)}div(t){if(0===t.x||0===t.y||0===t.z)throw new TypeError(`Can not divide by zero x:${t.x} y:${t.y} z: ${t.z}`);return new i(this.x/t.x,this.y/t.y,this.z/t.z)}mult(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}scale(t){return new i(this.x*t,this.y*t,this.z*t)}normalize(){const t=this.length();return new i(this.x/t,this.y/t,this.z/t)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}flatten(){return new Float32Array([this.x,this.y,this.z])}}e.Vector3=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0);e.OrthographicCamera=class{constructor(t){this.dimension=t,this.cameraMatrix=new i.Matrix4,this.cameraMatrix.setAsOrthographic(t)}matrix(){return this.cameraMatrix}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.PerspectiveCamera=class{constructor(){}matrix(){return this.cameraMatrix}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(6);e.PerspectiveCamera=i.PerspectiveCamera;var a=r(5);e.OrthographicCamera=a.OrthographicCamera},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.WebGLRenderer=class{constructor(t){this.width=0,this.height=0,this.devicePixelRatio=1,this.canvas=null,this._glCtx=null,void 0!==t&&this.initWithOptions(t)}getContext(){return this._glCtx}aspect(){return this.width/this.height}render(t){this.clear(),t.render(this._glCtx)}resize(t,e){this.canvas.width=this.width=t*this.devicePixelRatio,this.canvas.height=this.height=e*this.devicePixelRatio,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this._glCtx.viewport(0,0,this.width,this.height)}clear(){this._glCtx.clear(this._glCtx.COLOR_BUFFER_BIT|this._glCtx.DEPTH_BUFFER_BIT)}initWithOptions(t){if(this.width=t.width,this.height=t.height,this.devicePixelRatio=window.devicePixelRatio||1,t.domCanvas?this.canvas=t.domCanvas:(this.canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),document.body.appendChild(this.canvas)),t.fullscreen&&(this.width=document.body.clientWidth,this.height=document.body.clientHeight),this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.canvas.width=this.width*this.devicePixelRatio,this.canvas.height=this.height*this.devicePixelRatio,t.glContext)this._glCtx=t.glContext;else if(this._glCtx=this.canvas.getContext("webgl2")||this.canvas.getContext("webgl"),null===this._glCtx)throw new Error("glContext is null. Check WebGL compatibility");this._glCtx.viewport(0,0,this.width,this.height),this._glCtx.clearColor(1,0,1,1)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(8);e.WebGLRenderer=i.WebGLRenderer},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Shader=class{constructor(){this.shaderData=null,this.uniformData=new Map,this.attributeData=new Map}setShaderSource(t,e,r){const i=[],a=[],s=[],n=r.split("\n"),o=this.compileSource(t,e,r);for(const t of n){const e=";"===t.charAt(t.length-1)?t.length-1:t.length,r=t.substring(t.lastIndexOf(" ")+1,e);-1!==t.search(/^\s*(attribute)/gi)?i.push({name:r,id:-1}):-1!==t.search(/^\s*(uniform)/gi)?a.push({name:r,id:-1}):-1!==t.search(/^\s*(varying)/gi)&&s.push({name:r,id:-1})}this.shaderData={id:o,type:e,code:r,attributes:i,uniforms:a,varyings:s}}get ID(){return this.shaderData.id}get Attributes(){return this.attributeData}get Uniforms(){return this.uniformData}get Varyings(){return this.shaderData.varyings}setAttributeDataFor(t,e){const r=this.shaderData.attributes.filter(e=>e.name===t);if(0===r.length)throw new ReferenceError(`setAttributeDataFor: ${t} was not found`);this.attributeData.set({name:t,id:r[0].id},e)}setAttributeIDFor(t,e){for(const[r,i]of this.attributeData)if(r.name===t){this.attributeData.delete(r),this.attributeData.set({name:t,id:e},i);break}}setUniformDataFor(t,e){const r=this.shaderData.uniforms.filter(e=>e.name===t);if(0===r.length)throw new ReferenceError(`setUniformDataFor: ${t} was not found`);this.uniformData.set({name:t,id:r[0].id},e)}setUniformIDFor(t,e){for(const[r,i]of this.uniformData)if(r.name===t){this.uniformData.delete(r),this.uniformData.set({name:t,id:e},i);break}}compileSource(t,e,r){const i=t.createShader(e);return t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)||console.log(`Shader COMPILE_STATUS error: ${t.getShaderInfoLog(i)}`),i}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2);e.Scene=class{constructor(){this.shaders=new Map,this.renderables=[],this.camera=null,this.programId=null,this.programLinked=!1}addDrawable(...t){this.renderables.push(...t)}addCamera(t){this.camera=t}addShader(t,e,r){const a=new i.default;null===this.programId&&(this.programId=t.createProgram()),a.setShaderSource(t,e,r),t.attachShader(this.programId,a.ID),this.shaders.set(e,a)}shader(t){if(!this.shaders.has(t))throw new Error(`Scene does not have shader type ${t} assigned`);return this.shaders.get(t)}render(t){this.enableUniforms(t);for(const e of this.renderables)e.enableBuffer(t,this.programId),this.enableAttributes(t),t.drawArrays(t.TRIANGLE_STRIP,0,e.verticeCount())}enableAttributes(t){for(const e of this.shaders.values()){const r=e.Attributes;for(const[i,a]of r){if(-1===i.id){const r=t.getAttribLocation(this.programId,i.name);i.id=r,e.setAttributeIDFor(i.name,r)}if(t.enableVertexAttribArray(i.id),a.vertexAttribute)t.vertexAttribPointer(i.id,a.vertexAttribute.size,t.FLOAT,a.vertexAttribute.normalized,a.vertexAttribute.stride,a.vertexAttribute.offset);else if(a.attributeValue)switch(a.attributeValue.length){case 1:t.vertexAttrib1fv(i.id,a.attributeValue);break;case 2:t.vertexAttrib2fv(i.id,a.attributeValue);break;case 3:t.vertexAttrib3fv(i.id,a.attributeValue);break;case 4:t.vertexAttrib4fv(i.id,a.attributeValue)}}}}enableUniforms(t){this.programLinked||(this.programLinked=!0,t.linkProgram(this.programId),t.getProgramParameter(this.programId,t.LINK_STATUS)||console.log(`Error LINK_STATUS program Id ${t.getProgramInfoLog(this.programId)}`)),t.useProgram(this.programId);for(const e of this.shaders.values()){const r=e.Uniforms;for(const[i,a]of r){if(-1===i.id){const r=t.getUniformLocation(this.programId,i.name);i.id=r,e.setUniformIDFor(i.name,r)}if(a.dataMatrix&&t.uniformMatrix4fv(i.id,!1,a.dataMatrix.flatten()),a.dataValue)switch(a.dataValue.length){case 1:t.uniform1fv(i.id,a.dataValue);case 2:t.uniform2fv(i.id,a.dataValue);case 3:t.uniform3fv(i.id,a.dataValue);case 4:t.uniform4fv(i.id,a.dataValue)}}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Square=class{constructor(t,e,r,i){this.bufferId=null,this.vbo=new Float32Array(24),this.attribData=new Map,this.vbo[0]=t,this.vbo[1]=e,this.vbo[2]=0,this.vbo[3]=0,this.vbo[4]=0,this.vbo[5]=0,this.vbo[6]=t+r,this.vbo[7]=e,this.vbo[8]=0,this.vbo[9]=0,this.vbo[10]=0,this.vbo[11]=0,this.vbo[12]=t,this.vbo[13]=e+i,this.vbo[14]=0,this.vbo[15]=0,this.vbo[16]=0,this.vbo[17]=0,this.vbo[18]=t+r,this.vbo[19]=e+i,this.vbo[20]=0,this.vbo[21]=0,this.vbo[22]=0,this.vbo[23]=0}verticeCount(){return 4}setColor(t,e,r,i){for(let a=2;a<this.vbo.length;a+=2)this.vbo[a++]=t%256,this.vbo[a++]=e%256,this.vbo[a++]=r%256,this.vbo[a++]=i%256}setTexture(){throw new Error("Method not implemented.")}vertexAttributes(){return{size:2,normalized:!1,stride:24,offset:0}}colorAttributes(){return{size:4,normalized:!1,stride:24,offset:8}}enableBuffer(t,e){null===this.bufferId&&(this.bufferId=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.bufferId),t.bufferData(t.ARRAY_BUFFER,this.vbo,t.STATIC_DRAW)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(12);e.Square=i.Square;var a=r(11);e.Scene=a.Scene;var s=r(9);e.WebGLRenderer=s.WebGLRenderer;var n=r(7);e.OrthographicCamera=n.OrthographicCamera,e.PerspectiveCamera=n.PerspectiveCamera;var o=r(2);e.Shader=o.default,e.ShaderType=o.ShaderType,function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(0))}])});
//# sourceMappingURL=agent.js.map