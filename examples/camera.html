<html>

<head>
  <title>Geometric camera example</title>
</head>

<body>
  <script src="../lib/agent.js"></script>
  <script>
    const vshr = `
      attribute vec2 aPos;
      uniform mat4 camera;

      void main() {
        gl_Position = camera * vec4(aPos, 0.0, 1.0);
      }
    `;
    const fshr = `
      precision mediump float;
      uniform vec4 uColor;

      void main() {
        gl_FragColor = uColor;
      }
		`;
    let renderer = new Agent.WebGLRenderer({width: 400, height: 200});
    let square = new Agent.Square(10, 100, 150, 75);
    let square2 = new Agent.Square(210, 10, 100, 175);
    let square3 = new Agent.Square(300, 120, 50, 50);
    let camera = new Agent.OrthographicCamera({left:0, right:400, top:0, bottom:200, far:0, near:100});
    let scene = new Agent.Scene();
    let glCtx = renderer.getContext();

    scene.addShader(glCtx, Agent.ShaderType.Vertex, vshr);
    scene.addShader(glCtx, Agent.ShaderType.Fragment, fshr);

    scene.shader(Agent.ShaderType.Fragment)
      .setUniformDataFor('uColor', {dataValue: [0.0, 0.5, 1.0, 1.0]});

    scene.shader(Agent.ShaderType.Vertex)
      .setUniformDataFor('camera', {dataMatrix: camera.matrix()});

    scene.shader(Agent.ShaderType.Vertex)
      .setAttributeDataFor('aPos', {vertexAttribute: square.vertexAttributes()});

    scene.shader(Agent.ShaderType.Vertex)
      .setAttributeDataFor('aPos', {vertexAttribute: square2.vertexAttributes()});

    scene.shader(Agent.ShaderType.Vertex)
      .setAttributeDataFor('aPos', {vertexAttribute: square3.vertexAttributes()});

    scene.addDrawable(square, square2, square3);
    scene.addCamera(camera);

    renderer.render(scene);
  </script>
</body>

</html>